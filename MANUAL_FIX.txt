
// Add to updateProgressUI and updateRankDisplay
function updateProgressUI() {
  const totalWords = state.learnedIds.length;
  const goal = 50;
  const percentage = Math.min((totalWords / goal) * 100, 100);

  document.getElementById("learnedCount").textContent = totalWords;
  document.getElementById("progressBar").style.width = percentage + "%";
  
  // Update rank and points display
  const rank = getRank(state.totalPoints);
  const starsDisplay = document.getElementById("starsDisplay");
  if (starsDisplay) {
    starsDisplay.textContent = `${rank.icon} ${state.totalPoints} Puan`;
  }
  
  // Update rank name separately
  const rankNameEl = document.getElementById("rankName");
  if (rankNameEl) {
    rankNameEl.textContent = rank.name;
  }
  
  // Update logo with current rank
  updateRankDisplay();
}

function updateRankDisplay() {
  const rank = getRank(state.totalPoints);
  const logoSpan = document.querySelector('.logo span');
  if (logoSpan) {
    logoSpan.textContent = rank.name;
  }
  
  // Also update rank name in status bar
  const rankNameEl = document.getElementById("rankName");
  if (rankNameEl) {
    rankNameEl.textContent = rank.name;
  }
}

// Add to setLanguage
function setLanguage(lang) {
  state.lang = lang;
  document
    .querySelectorAll(".flag-btn")
    .forEach((b) => b.classList.remove("active"));
  event.target.classList.add("active");

  const texts = translations[lang];
  document.querySelectorAll("[data-i18n]").forEach((el) => {
    const key = el.getAttribute("data-i18n");
    if (texts[key]) el.textContent = texts[key];
  });

  document.querySelector('[data-ph="enterName"]')?.setAttribute('placeholder', texts.enterName);

  // Re-render all content with new language
  renderFlashcards();
  renderGrammar();
  renderExams();
  renderReading();
  
  // Update rank display in new language
  updateRankDisplay();
  updateProgressUI();
  
  // Update user welcome message if exists
  const name = state.user.name;
  if (name) {
    const text = document.getElementById("welcomeText");
    if (text) text.textContent = texts.welcome + " " + name;
  }
}
